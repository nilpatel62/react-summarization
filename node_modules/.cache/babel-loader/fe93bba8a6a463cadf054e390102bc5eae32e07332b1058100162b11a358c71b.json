{"ast":null,"code":"import { createBroker } from 'broker-factory';\nimport { addUniqueNumber } from 'fast-unique-numbers';\n/*\n * @todo Explicitly referencing the barrel file seems to be necessary when enabling the\n * isolatedModules compiler option.\n */\nexport * from './interfaces/index';\nexport * from './types/index';\nconst encoderIds = new Set();\nexport const wrap = createBroker({\n  encode: _ref => {\n    let {\n      call\n    } = _ref;\n    return async (encoderId, timeslice) => {\n      const arrayBuffers = await call('encode', {\n        encoderId,\n        timeslice\n      });\n      encoderIds.delete(encoderId);\n      return arrayBuffers;\n    };\n  },\n  instantiate: _ref2 => {\n    let {\n      call\n    } = _ref2;\n    return async (mimeType, sampleRate) => {\n      const encoderId = addUniqueNumber(encoderIds);\n      const port = await call('instantiate', {\n        encoderId,\n        mimeType,\n        sampleRate\n      });\n      return {\n        encoderId,\n        port\n      };\n    };\n  },\n  register: _ref3 => {\n    let {\n      call\n    } = _ref3;\n    return port => {\n      return call('register', {\n        port\n      }, [port]);\n    };\n  }\n});\nexport const load = url => {\n  const worker = new Worker(url);\n  return wrap(worker);\n};","map":{"version":3,"names":["createBroker","addUniqueNumber","encoderIds","Set","wrap","encode","_ref","call","encoderId","timeslice","arrayBuffers","delete","instantiate","_ref2","mimeType","sampleRate","port","register","_ref3","load","url","worker","Worker"],"sources":["/Users/neelpatel/Desktop/react_application/pushup_counter/node_modules/media-encoder-host-broker/src/module.ts"],"sourcesContent":["import { createBroker } from 'broker-factory';\nimport { addUniqueNumber } from 'fast-unique-numbers';\nimport { TMediaEncoderHostWorkerDefinition } from 'media-encoder-host-worker';\nimport { IMediaEncoderHostBrokerDefinition } from './interfaces';\nimport { TMediaEncoderHostBrokerLoader, TMediaEncoderHostBrokerWrapper } from './types';\n\n/*\n * @todo Explicitly referencing the barrel file seems to be necessary when enabling the\n * isolatedModules compiler option.\n */\nexport * from './interfaces/index';\nexport * from './types/index';\n\nconst encoderIds: Set<number> = new Set();\n\nexport const wrap: TMediaEncoderHostBrokerWrapper = createBroker<IMediaEncoderHostBrokerDefinition, TMediaEncoderHostWorkerDefinition>({\n    encode: ({ call }) => {\n        return async (encoderId, timeslice) => {\n            const arrayBuffers = await call('encode', { encoderId, timeslice });\n\n            encoderIds.delete(encoderId);\n\n            return arrayBuffers;\n        };\n    },\n    instantiate: ({ call }) => {\n        return async (mimeType, sampleRate) => {\n            const encoderId = addUniqueNumber(encoderIds);\n            const port = await call('instantiate', { encoderId, mimeType, sampleRate });\n\n            return { encoderId, port };\n        };\n    },\n    register: ({ call }) => {\n        return (port) => {\n            return call('register', { port }, [port]);\n        };\n    }\n});\n\nexport const load: TMediaEncoderHostBrokerLoader = (url: string) => {\n    const worker = new Worker(url);\n\n    return wrap(worker);\n};\n"],"mappings":"AAAA,SAASA,YAAY,QAAQ,gBAAgB;AAC7C,SAASC,eAAe,QAAQ,qBAAqB;AAKrD;;;;AAIA,cAAc,oBAAoB;AAClC,cAAc,eAAe;AAE7B,MAAMC,UAAU,GAAgB,IAAIC,GAAG,EAAE;AAEzC,OAAO,MAAMC,IAAI,GAAmCJ,YAAY,CAAuE;EACnIK,MAAM,EAAEC,IAAA,IAAa;IAAA,IAAZ;MAAEC;IAAI,CAAE,GAAAD,IAAA;IACb,OAAO,OAAOE,SAAS,EAAEC,SAAS,KAAI;MAClC,MAAMC,YAAY,GAAG,MAAMH,IAAI,CAAC,QAAQ,EAAE;QAAEC,SAAS;QAAEC;MAAS,CAAE,CAAC;MAEnEP,UAAU,CAACS,MAAM,CAACH,SAAS,CAAC;MAE5B,OAAOE,YAAY;IACvB,CAAC;EACL,CAAC;EACDE,WAAW,EAAEC,KAAA,IAAa;IAAA,IAAZ;MAAEN;IAAI,CAAE,GAAAM,KAAA;IAClB,OAAO,OAAOC,QAAQ,EAAEC,UAAU,KAAI;MAClC,MAAMP,SAAS,GAAGP,eAAe,CAACC,UAAU,CAAC;MAC7C,MAAMc,IAAI,GAAG,MAAMT,IAAI,CAAC,aAAa,EAAE;QAAEC,SAAS;QAAEM,QAAQ;QAAEC;MAAU,CAAE,CAAC;MAE3E,OAAO;QAAEP,SAAS;QAAEQ;MAAI,CAAE;IAC9B,CAAC;EACL,CAAC;EACDC,QAAQ,EAAEC,KAAA,IAAa;IAAA,IAAZ;MAAEX;IAAI,CAAE,GAAAW,KAAA;IACf,OAAQF,IAAI,IAAI;MACZ,OAAOT,IAAI,CAAC,UAAU,EAAE;QAAES;MAAI,CAAE,EAAE,CAACA,IAAI,CAAC,CAAC;IAC7C,CAAC;EACL;CACH,CAAC;AAEF,OAAO,MAAMG,IAAI,GAAmCC,GAAW,IAAI;EAC/D,MAAMC,MAAM,GAAG,IAAIC,MAAM,CAACF,GAAG,CAAC;EAE9B,OAAOhB,IAAI,CAACiB,MAAM,CAAC;AACvB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}