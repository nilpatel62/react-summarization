{"ast":null,"code":"import { generateUniqueNumber } from 'fast-unique-numbers';\nimport { renderUnknownPortIdError } from './error-renderers';\nimport { isSupportingTransferables } from './is-supporting-transferables';\nconst DESTROY_WORKER_FUNCTIONS = new Map();\nexport const extendWorkerImplementation = (createWorker, partialWorkerImplementation, isSupportedFunction) => ({\n  ...partialWorkerImplementation,\n  connect: _ref => {\n    let {\n      port\n    } = _ref;\n    port.start();\n    const destroyWorker = createWorker(port, partialWorkerImplementation);\n    const portId = generateUniqueNumber(DESTROY_WORKER_FUNCTIONS);\n    DESTROY_WORKER_FUNCTIONS.set(portId, () => {\n      destroyWorker();\n      port.close();\n      DESTROY_WORKER_FUNCTIONS.delete(portId);\n    });\n    return {\n      result: portId\n    };\n  },\n  disconnect: _ref2 => {\n    let {\n      portId\n    } = _ref2;\n    const destroyWorker = DESTROY_WORKER_FUNCTIONS.get(portId);\n    if (destroyWorker === undefined) {\n      throw renderUnknownPortIdError({\n        portId: portId.toString()\n      });\n    }\n    destroyWorker();\n    return {\n      result: null\n    };\n  },\n  isSupported: async () => {\n    const isSelfSupported = await isSupportingTransferables();\n    if (isSelfSupported) {\n      const result = isSupportedFunction();\n      const synchronousResult = result instanceof Promise ? await result : result;\n      return {\n        result: synchronousResult\n      };\n    }\n    return {\n      result: false\n    };\n  }\n});","map":{"version":3,"names":["generateUniqueNumber","renderUnknownPortIdError","isSupportingTransferables","DESTROY_WORKER_FUNCTIONS","Map","extendWorkerImplementation","createWorker","partialWorkerImplementation","isSupportedFunction","connect","_ref","port","start","destroyWorker","portId","set","close","delete","result","disconnect","_ref2","get","undefined","toString","isSupported","isSelfSupported","synchronousResult","Promise"],"sources":["/Users/neelpatel/Desktop/react_application/pushup_counter/node_modules/recorder-audio-worklet/node_modules/worker-factory/src/helpers/extend-worker-implementation.ts"],"sourcesContent":["import { generateUniqueNumber } from 'fast-unique-numbers';\nimport { IDefaultWorkerDefinition, IReceiver, IWorkerDefinition } from '../interfaces';\nimport { TDestroyWorkerFunction, TWorkerImplementation } from '../types';\nimport { renderUnknownPortIdError } from './error-renderers';\nimport { isSupportingTransferables } from './is-supporting-transferables';\n\nconst DESTROY_WORKER_FUNCTIONS: Map<number, TDestroyWorkerFunction> = new Map();\n\nexport const extendWorkerImplementation = <T extends IWorkerDefinition>(\n    createWorker: (receiver: IReceiver, workerImplementation: TWorkerImplementation<T>) => TDestroyWorkerFunction,\n    partialWorkerImplementation: TWorkerImplementation<T>,\n    isSupportedFunction: () => boolean | Promise<boolean>\n): TWorkerImplementation<T> & TWorkerImplementation<IDefaultWorkerDefinition> => ({\n    ...partialWorkerImplementation,\n    connect: ({ port }) => {\n        port.start();\n\n        const destroyWorker = createWorker(port, partialWorkerImplementation);\n        const portId = generateUniqueNumber(DESTROY_WORKER_FUNCTIONS);\n\n        DESTROY_WORKER_FUNCTIONS.set(portId, () => {\n            destroyWorker();\n            port.close();\n            DESTROY_WORKER_FUNCTIONS.delete(portId);\n        });\n\n        return { result: portId };\n    },\n    disconnect: ({ portId }) => {\n        const destroyWorker = DESTROY_WORKER_FUNCTIONS.get(portId);\n\n        if (destroyWorker === undefined) {\n            throw renderUnknownPortIdError({ portId: portId.toString() });\n        }\n\n        destroyWorker();\n\n        return { result: null };\n    },\n    isSupported: async () => {\n        const isSelfSupported = await isSupportingTransferables();\n\n        if (isSelfSupported) {\n            const result = isSupportedFunction();\n            const synchronousResult = result instanceof Promise ? await result : result;\n\n            return { result: synchronousResult };\n        }\n\n        return { result: false };\n    }\n});\n"],"mappings":"AAAA,SAASA,oBAAoB,QAAQ,qBAAqB;AAG1D,SAASC,wBAAwB,QAAQ,mBAAmB;AAC5D,SAASC,yBAAyB,QAAQ,+BAA+B;AAEzE,MAAMC,wBAAwB,GAAwC,IAAIC,GAAG,EAAE;AAE/E,OAAO,MAAMC,0BAA0B,GAAGA,CACtCC,YAA6G,EAC7GC,2BAAqD,EACrDC,mBAAqD,MACyB;EAC9E,GAAGD,2BAA2B;EAC9BE,OAAO,EAAEC,IAAA,IAAa;IAAA,IAAZ;MAAEC;IAAI,CAAE,GAAAD,IAAA;IACdC,IAAI,CAACC,KAAK,EAAE;IAEZ,MAAMC,aAAa,GAAGP,YAAY,CAACK,IAAI,EAAEJ,2BAA2B,CAAC;IACrE,MAAMO,MAAM,GAAGd,oBAAoB,CAACG,wBAAwB,CAAC;IAE7DA,wBAAwB,CAACY,GAAG,CAACD,MAAM,EAAE,MAAK;MACtCD,aAAa,EAAE;MACfF,IAAI,CAACK,KAAK,EAAE;MACZb,wBAAwB,CAACc,MAAM,CAACH,MAAM,CAAC;IAC3C,CAAC,CAAC;IAEF,OAAO;MAAEI,MAAM,EAAEJ;IAAM,CAAE;EAC7B,CAAC;EACDK,UAAU,EAAEC,KAAA,IAAe;IAAA,IAAd;MAAEN;IAAM,CAAE,GAAAM,KAAA;IACnB,MAAMP,aAAa,GAAGV,wBAAwB,CAACkB,GAAG,CAACP,MAAM,CAAC;IAE1D,IAAID,aAAa,KAAKS,SAAS,EAAE;MAC7B,MAAMrB,wBAAwB,CAAC;QAAEa,MAAM,EAAEA,MAAM,CAACS,QAAQ;MAAE,CAAE,CAAC;;IAGjEV,aAAa,EAAE;IAEf,OAAO;MAAEK,MAAM,EAAE;IAAI,CAAE;EAC3B,CAAC;EACDM,WAAW,EAAE,MAAAA,CAAA,KAAW;IACpB,MAAMC,eAAe,GAAG,MAAMvB,yBAAyB,EAAE;IAEzD,IAAIuB,eAAe,EAAE;MACjB,MAAMP,MAAM,GAAGV,mBAAmB,EAAE;MACpC,MAAMkB,iBAAiB,GAAGR,MAAM,YAAYS,OAAO,GAAG,MAAMT,MAAM,GAAGA,MAAM;MAE3E,OAAO;QAAEA,MAAM,EAAEQ;MAAiB,CAAE;;IAGxC,OAAO;MAAER,MAAM,EAAE;IAAK,CAAE;EAC5B;CACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}